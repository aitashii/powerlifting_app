<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌸 6xSBD - Powerlifting Tracker 🐱</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Personal Powerlifting Training Tracker by Agata Sitko methodology">
    <meta name="theme-color" content="#D4A5A5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="6xSBD Tracker">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌸</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌸</text></svg>">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Chart.js for Progress Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
      // Import Firebase functions
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
      import { getAuth, signInWithPopup, signOut, onAuthStateChanged, GithubAuthProvider } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
      import { getFirestore, doc, setDoc, getDoc, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
      
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDkCic6MtVJMr3LasUbAhNy6xRKHYG6Jps",
        authDomain: "aitashii-powerlifting.firebaseapp.com",
        projectId: "aitashii-powerlifting",
        storageBucket: "aitashii-powerlifting.firebasestorage.app",
        messagingSenderId: "563801348727",
        appId: "1:563801348727:web:433d2a660c6b2b4dc10472",
        measurementId: "G-4VK5P34B96"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      
      // Make Firebase available globally
      window.firebaseAuth = auth;
      window.firebaseDb = db;
      window.firebaseSignInWithPopup = signInWithPopup;
      window.firebaseSignOut = signOut;
      window.firebaseOnAuthStateChanged = onAuthStateChanged;
      window.firebaseGithubAuthProvider = GithubAuthProvider;
      window.firebaseDoc = doc;
      window.firebaseSetDoc = setDoc;
      window.firebaseGetDoc = getDoc;
      window.firebaseOnSnapshot = onSnapshot;
      window.firebaseServerTimestamp = serverTimestamp;
      
      console.log('🔥 Firebase initialized successfully');
    </script>
</head>
<body>
    <div class="app">
        <!-- 🍔 Mobile Header with Hamburger -->
        <header class="mobile-header">
            <button id="hamburger-btn" class="hamburger-btn" aria-label="Menu">
                <div class="hamburger-line"></div>
                <div class="hamburger-line"></div>
                <div class="hamburger-line"></div>
            </button>
            
            <div class="header-brand">
                <h1>🌸 6xSBD 🐱</h1>
                <div class="date-control-header">
                    <input type="date" id="current-date-picker" class="date-input">
                    <div class="date-info" id="date-info">Ładowanie...</div>
                    <button onclick="setToday()" class="btn btn--small">Dziś</button>
                </div>
            </div>
            
            <div class="header-actions">
                <div id="auth-status">
                    <button id="login-btn" class="btn btn--primary" style="display: none;">
                        <span>🔐 Login</span>
                    </button>
                    <div id="user-info" style="display: none;">
                        <img id="user-avatar" style="width: 32px; height: 32px; border-radius: 50%; margin-right: 8px;">
                        <button id="logout-btn" class="btn btn--small">Logout</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- 📱 Menu Overlay -->
        <div id="menu-overlay" class="menu-overlay"></div>

        <!-- 🌸 Sliding Menu -->
        <nav id="sliding-menu" class="sliding-menu">
            <div class="menu-header">
                <div class="menu-brand">
                    <h2>🌸 6xSBD</h2>
                </div>
                <button id="close-menu-btn" class="close-menu-btn">&times;</button>
            </div>
            
            <div class="menu-items">
                <button class="menu-item active" data-section="dashboard">
                    <span class="menu-icon">📊</span>
                    <span class="menu-text">Dashboard</span>
                </button>
                <button class="menu-item" data-section="workout">
                    <span class="menu-icon">💪</span>
                    <span class="menu-text">Dzisiejszy Trening</span>
                </button>
                <button class="menu-item" data-section="treningi">
                    <span class="menu-icon">📅</span>
                    <span class="menu-text">Treningi</span>
                </button>
                <button class="menu-item" data-section="zywienie">
                    <span class="menu-icon">🥗</span>
                    <span class="menu-text">Żywienie</span>
                </button>
                <button class="menu-item" data-section="progress">
                    <span class="menu-icon">📈</span>
                    <span class="menu-text">Progres</span>
                </button>
                <button class="menu-item" data-section="cycle">
                    <span class="menu-icon">🌙</span>
                    <span class="menu-text">Cykl</span>
                </button>
                <button class="menu-item" data-section="backup">
                    <span class="menu-icon">💾</span>
                    <span class="menu-text">Backup</span>
                </button>
            </div>
            
            <div class="menu-footer">
                <div class="auto-backup-status">
                    <span class="backup-counter" id="backup-counter">0/3 zmian</span>
                    <div class="backup-progress">
                        <div class="backup-progress-fill" id="backup-progress-fill"></div>
                    </div>
                </div>
                <p class="menu-motivational">Każdy trening to krok naprzód! 💪🌸</p>
            </div>
        </nav>

        <!-- 📱 Smart Notifications -->
        <div id="notifications-container" class="notifications-container"></div>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                
                <!-- 📊 Dashboard Section -->
                <section id="dashboard" class="section section--active">
                    <div class="welcome-header">
                        <h2>🌸 Dashboard 🐱</h2>
                        <p class="welcome-subtitle">Twój personalny powerlifting tracker</p>
                        <div id="sync-status" class="sync-status">
                            <span id="sync-indicator">📱 Tryb lokalny</span>
                        </div>
                    </div>

                    <!-- Date Status Card -->
                    <div class="card date-status-card">
                        <div class="card__header">
                            <h3>📅 Status Dnia</h3>
                            <div class="date-controls">
                                <input type="date" id="dashboard-date-picker" class="date-input">
                            </div>
                        </div>
                        <div class="card__content">
                            <div class="date-status-grid">
                                <div class="status-item">
                                    <div class="status-label">Aktualna Data</div>
                                    <div class="status-value" id="current-date-display">25 sierpnia 2025</div>
                                </div>
                                <div class="status-item">
                                    <div class="status-label">Typ Dnia</div>
                                    <div class="status-value" id="day-type">Dzień treningowy</div>
                                </div>
                                <div class="status-item">
                                    <div class="status-label">Faza Treningu</div>
                                    <div class="status-value" id="phase-indicator">Faza 1/4 - HYPERTROPHY</div>
                                </div>
                                <div class="status-item">
                                    <div class="status-label">Do Zawodów</div>
                                    <div class="status-value" id="competition-countdown">217 dni</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Grid -->
                    <div class="summary-grid">
                        <!-- Current PRs -->
                        <div class="card">
                            <div class="card__header">
                                <h3>🏆 Aktualne PR</h3>
                                <span class="status status--success">Aktywne</span>
                            </div>
                            <div class="card__content">
                                <div class="pr-grid">
                                    <div class="pr-item">
                                        <div class="pr-label">Squat</div>
                                        <div class="pr-value">40kg x5</div>
                                        <div class="pr-date" id="squat-pr-days">2 dni temu</div>
                                    </div>
                                    <div class="pr-item">
                                        <div class="pr-label">Bench</div>
                                        <div class="pr-value">45kg</div>
                                        <div class="pr-date" id="bench-pr-days">2 dni temu</div>
                                    </div>
                                    <div class="pr-item">
                                        <div class="pr-label">Deadlift</div>
                                        <div class="pr-value">90kg</div>
                                        <div class="pr-date" id="deadlift-pr-days">25 dni temu</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Body Composition -->
                        <div class="card">
                            <div class="card__header">
                                <h3>📊 Skład Ciała</h3>
                                <span class="status status--info">W trakcie</span>
                            </div>
                            <div class="card__content">
                                <div class="body-comp-grid">
                                    <div class="comp-item">
                                        <div class="comp-label">Cel wagowy</div>
                                        <div class="comp-progress">
                                            <div class="comp-current">84.1kg</div>
                                            <div class="progress-bar">
                                                <div class="progress-fill progress-fill--warning"></div>
                                            </div>
                                            <div class="comp-target">72kg</div>
                                        </div>
                                    </div>
                                    <div class="comp-item">
                                        <div class="comp-label">Redukcja tłuszczu</div>
                                        <div class="comp-progress">
                                            <div class="comp-current">32.7kg</div>
                                            <div class="progress-bar">
                                                <div class="progress-fill progress-fill--warning"></div>
                                            </div>
                                            <div class="comp-target">13.0kg</div>
                                        </div>
                                    </div>
                                    <div class="comp-item">
                                        <div class="comp-label">Wzrost mięśni</div>
                                        <div class="comp-progress">
                                            <div class="comp-current">27.1kg</div>
                                            <div class="progress-bar">
                                                <div class="progress-fill progress-fill--success"></div>
                                            </div>
                                            <div class="comp-target">32.7kg</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 💪 Workout Section -->
                <section id="workout" class="section">
                    <h2 id="workout-title">💪 Dzisiejszy Trening</h2>

                    <div class="card">
                        <div class="card__header">
                            <h3 id="workout-detail-title">Trening na Poniedziałek</h3>
                            <span id="workout-status" class="status status--success">Dzień treningowy</span>
                        </div>
                        <div class="card__content">
                            <div id="workout-summary" class="workout-summary">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h3>📋 Szczegóły Treningu</h3>
                        </div>
                        <div class="card__content">
                            <div id="workout-exercises">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 📅 Training Schedule Section -->
                <section id="treningi" class="section">
                    <h2>📅 Plan Treningowy</h2>
                    
                    <div class="card">
                        <div class="card__header">
                            <h3>🗓️ Kalendarz Treningowy</h3>
                            <span class="status status--info">Sierpień 2025</span>
                        </div>
                        <div class="card__content">
                            <div id="training-calendar">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 🥗 Nutrition Section -->
                <section id="zywienie" class="section">
                    <h2 id="nutrition-title">🥗 Żywienie</h2>
                    
                    <div class="card">
                        <div class="card__header">
                            <h3>🎯 Dzienne Cele</h3>
                            <span id="nutrition-status" class="status status--success">Dzień treningowy</span>
                        </div>
                        <div class="card__content">
                            <div id="nutrition-targets">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 📈 Progress Section -->
                <section id="progress" class="section">
                    <h2>📈 Twój Progres</h2>
                    
                    <!-- Charts Grid -->
                    <div class="summary-grid">
                        <div class="card">
                            <div class="card__header">
                                <h3>🏆 Progres Siłowy</h3>
                            </div>
                            <div class="card__content">
                                <div style="height: 400px;">
                                    <canvas id="pr-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card__header">
                                <h3>📊 Skład Ciała</h3>
                            </div>
                            <div class="card__content">
                                <div style="height: 400px;">
                                    <canvas id="body-composition-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add New PR -->
                    <div class="card">
                        <div class="card__header">
                            <h3>🆕 Dodaj Nowe PR</h3>
                        </div>
                        <div class="card__content">
                            <form id="pr-form" class="form">
                                <div class="form-group">
                                    <label for="exercise">Ćwiczenie</label>
                                    <select id="exercise" required>
                                        <option value="">Wybierz ćwiczenie</option>
                                        <option value="squat">Squat</option>
                                        <option value="bench">Bench Press</option>
                                        <option value="deadlift">Deadlift</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="weight">Ciężar (kg)</label>
                                    <input type="number" id="weight" step="0.5" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="reps">Powtórzenia</label>
                                    <input type="number" id="reps" min="1" max="20" required>
                                </div>
                                <div class="form-group">
                                    <label for="pr-date">Data</label>
                                    <input type="date" id="pr-date" required>
                                </div>
                                <button type="submit" class="btn btn--primary">🏆 Dodaj PR</button>
                            </form>
                        </div>
                    </div>

                    <!-- Add New Measurement -->
                    <div class="card">
                        <div class="card__header">
                            <h3>📏 Dodaj Pomiar</h3>
                        </div>
                        <div class="card__content">
                            <form id="measurements-form" class="form">
                                <div class="form-group">
                                    <label for="measurement-date">Data</label>
                                    <input type="date" id="measurement-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="measurement-weight">Waga (kg)</label>
                                    <input type="number" id="measurement-weight" step="0.1" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="measurement-bodyfat">Body Fat (%)</label>
                                    <input type="number" id="measurement-bodyfat" step="0.1" min="0" max="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="measurement-muscle">Masa mięśniowa (kg)</label>
                                    <input type="number" id="measurement-muscle" step="0.1" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="measurement-fatmass">Masa tłuszczowa (kg)</label>
                                    <input type="number" id="measurement-fatmass" step="0.1" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="measurement-bodywater">Body Water (kg)</label>
                                    <input type="number" id="measurement-bodywater" step="0.1" min="0" required>
                                </div>
                                <button type="submit" class="btn btn--primary">📊 Dodaj Pomiar</button>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- 🌙 Menstrual Cycle Section -->
                <section id="cycle" class="section">
                    <h2>🌙 Cykl Menstruacyjny</h2>
                    
                    <div class="card">
                        <div class="card__header">
                            <h3>📊 Aktualny Status</h3>
                        </div>
                        <div class="card__content">
                            <div class="cycle-info">
                                <div class="cycle-item">
                                    <span class="cycle-label">Faza cyklu</span>
                                    <span class="cycle-value" id="cycle-phase">Menstruacja</span>
                                </div>
                                <div class="cycle-item">
                                    <span class="cycle-label">Dzień cyklu</span>
                                    <span class="cycle-value" id="cycle-day">5/28</span>
                                </div>
                                <div class="cycle-item">
                                    <span class="cycle-label">Dni od ostatniej</span>
                                    <span class="cycle-value" id="days-since-period">5 dni</span>
                                </div>
                            </div>
                            <div class="cycle-recommendation" id="cycle-recommendation">
                                Lekkie treningi, słuchaj swojego ciała 🌙
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h3>📝 Aktualizuj Cykl</h3>
                        </div>
                        <div class="card__content">
                            <form id="cycle-form" class="form">
                                <div class="form-group">
                                    <label for="period-start">Początek ostatniej miesiączki</label>
                                    <input type="date" id="period-start" required>
                                </div>
                                <div class="form-group">
                                    <label for="period-end">Koniec ostatniej miesiączki</label>
                                    <input type="date" id="period-end" required>
                                </div>
                                <div class="form-group">
                                    <label for="cycle-length">Długość cyklu (dni)</label>
                                    <input type="number" id="cycle-length" min="21" max="35" value="28" required>
                                </div>
                                <button type="submit" class="btn btn--primary">🌙 Aktualizuj Cykl</button>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- 💾 Backup Section -->
                <section id="backup" class="section">
                    <h2>💾 Backup & Sync</h2>
                    
                    <div class="card backup-status-card">
                        <div class="card__header">
                            <h3>📊 Status Auto-Backup</h3>
                            <span class="status status--info">Aktywny</span>
                        </div>
                        <div class="card__content">
                            <div class="backup-info">
                                <div class="backup-stat">
                                    <span class="stat-label">Zmiany od backupu</span>
                                    <span class="stat-value" id="changes-since-backup">0</span>
                                </div>
                                <div class="backup-stat">
                                    <span class="stat-label">Ostatni backup</span>
                                    <span class="stat-value" id="last-backup-time">Brak</span>
                                </div>
                                <div class="backup-stat">
                                    <span class="stat-label">Następny backup</span>
                                    <span class="stat-value" id="next-backup">Po 3 zmianach</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="backup-actions">
                        <div class="card">
                            <div class="card__header">
                                <h3>📤 Eksport Danych</h3>
                            </div>
                            <div class="card__content">
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <button id="manual-backup-btn" class="btn btn--primary">
                                        💾 Manual Backup
                                    </button>
                                    <button id="export-trainer-btn" class="btn btn--secondary">
                                        📊 Export dla Trenera
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="restore-section">
                            <h4>📥 Przywróć z Backupu</h4>
                            <div id="backup-drop-zone" class="drop-zone">
                                <p>Przeciągnij plik backupu tutaj lub kliknij aby wybrać</p>
                                <input type="file" id="restore-file-input" accept=".json" style="display: none;">
                            </div>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- App JavaScript -->
    <script src="app.js"></script>
</body>
</html>
